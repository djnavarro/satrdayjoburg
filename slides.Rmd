---
title: "Data Visualisation in R"
subtitle: "From ggplot2 to gganimate"
author: "<br><br>Danielle Navarro &nbsp;&nbsp;&nbsp;`r anicon::faa('twitter', animate='float', rtext=' @djnavarro')`"
date: "https://djnavarro.github.io/satrdayjoburg/<br><br>6 April 2019"
output:
  xaringan::moon_reader:
    lib_dir: libs
    chakra: libs/remark-latest.min.js    
    css: ["kunoichi", "ninjutsu" , "assets/ninpo.css", "assets/danielle.css"]
    self_contained: false
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE, message = FALSE}
options(htmltools.dir.version = FALSE)
library(here)
library(tidyverse)
frames <- read_csv(here("data","frames_ex2.csv"))
beaches <- read_csv(here("data","sydneybeaches2.csv"))
```

class: split-two bg-main1

.column.bg-main1[.content.vmiddle.center[

# Data visualisation

<br>

.pull.left[.pad1[

### .orange[**What?**] Drawing pictures
### .orange[**Why?**] Understand your data
### .orange[**How?**] Using tidyverse (ggplot2)

]]

]]

.column.bg-main3[.content.vmiddle.center[

<img src="images/horst_ggplot.png", width="70%">

[@allison_horst](https://twitter.com/allison_horst)

]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[The Sydney Beaches Data]
]]





<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 middle center

.pull.left[.pad1[.font2[
```{r beachesdata, eval=TRUE, message=FALSE}
beaches <- here("data","sydneybeaches2.csv") %>% read_csv() 
beaches
```
]]]




<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Painting a Picture]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[

## A grammar...

- grammars compose & reuse small parts
- complex structures from simpler units

## ...of graphics

- uses the "painters model"
- a plot is built in layers
- each layer is drawn on top of the last

]]]
]]

.column.bg-main3[.content.vmiddle.center[

<img src="images/trinity-treft-696428-unsplash.jpg", width="70%">

[Image credit: Trinity Treft](https://unsplash.com/photos/waYWz3vAYJQ)

]]







<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[

A blank canvas

```{r, eval=FALSE, message = FALSE}
ggplot()
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r blankcanvas, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE}
ggplot() 
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Specify the data
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches #<<
)
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r stillblankcanvas, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE}
ggplot(
  data = beaches #<<
) 
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Specify the aesthetics
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(      #<<
    x = temp_airport, #<<
    y = rain_mm       #<<
  )                   #<<
)
```

- x-axis location
- y-axis location
- colour of marker
- fill of a marker
- shape of a marker
]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r aesthetics, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
)
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add a layer
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point() #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_layer, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point() #<<
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add layer-specific aesthetics
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(size = 3) #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_fixedaesthetic, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(size = 3) #<<
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add layer-specific mappings
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), #<<
  size = 3
)   
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_layeraesthetic, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), #<<
  size = 3
) 
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add more layers
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season),
  size = 3
) + 
geom_rug() #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r two_layers, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 3
) + 
geom_rug()
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Split into facets
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2
) + 
geom_rug() + 
facet_wrap(vars(season)) #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_facets, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2
) + 
geom_rug() + 
facet_wrap(vars(season)) #<<
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Remove an unwanted legend
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE #<<
) + 
geom_rug() + 
facet_wrap(vars(season)) 
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r remove_legend, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE #<<
) + 
geom_rug() + 
facet_wrap(vars(season)) 
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Modify the theme
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE 
) + 
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_theme, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE #<<
) +
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() 
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
(Nothing to see here...)
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm)) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE) + 
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_theme2, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE #<<
) +
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() 
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Make nicer titles
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm)) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE) +  
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( #<<
  label = "Sydney weather by season", #<<
  subtitle = "Data from 2013 to 2018" #<<
) + #<<
xlab("Temperature (Celsius)") + #<<
ylab("Rainfall (mm)") #<<

```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_titles, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE
) +
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() + 
ggtitle( 
  label = "Sydney weather by season", #<<
  subtitle = "Data from 2013 to 2018" #<<
) + #<<
xlab("Temperature (Celsius)") + #<<
ylab("Rainfall (mm)") #<<
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Done!
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm)) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE) +  
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle(
  label = "Sydney weather by season",
  subtitle = "Data from 2013 to 2018") + 
xlab("Temperature (Celsius)") +
ylab("Rainfall (mm)") 
```
]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r done, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temp_airport, 
    y = rain_mm
  ) 
) + 
geom_point(
  mapping = aes(colour = season), 
  size = 2,
  show.legend = FALSE
) +
geom_rug() + 
facet_wrap(vars(season)) + 
theme_bw() + 
ggtitle( 
  label = "Sydney weather by season", #<<
  subtitle = "Data from 2013 to 2018" #<<
) + #<<
xlab("Temperature (Celsius)") + #<<
ylab("Rainfall (mm)") #
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---

class: center middle hide-slide-number

.pad1[
.font4[
Exercise: Test drive with ggplot2 <br>
https://djnavarro.github.io/some_url_here
]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Introducing ggplot objects]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Let's create a plot with no layers!
```{r, eval=FALSE, message = FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temp_airport) 
) + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( 
  label = "Sydney temperature by season",
  subtitle = "Data from 2013 to 2018"
) + 
xlab("Temperature (Celsius)") +
ylab("") 
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r baseplot_noprint, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temp_airport) 
) + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( 
  label = "Sydney temperature by season",
  subtitle = "Data from 2013 to 2018"
) +
xlab("Temperature (Celsius)") +
ylab("") 
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Let's create a plot with no layers!
```{r, eval=FALSE, message = FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temp_airport) 
) + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( 
  label = "Sydney temperature by season",
  subtitle = "Data from 2013 to 2018"
) +
xlab("Temperature (Celsius)") +
ylab("") 

plot(pic) #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r baseplot_plotted, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temp_airport) 
) + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( 
  label = "Sydney temperature by season",
  subtitle = "Data from 2013 to 2018"
) +
xlab("Temperature (Celsius)") +
ylab("") 

plot(pic)
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Let's create a plot with no layers!
```{r, eval=FALSE, message = FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temp_airport) 
) + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( 
  label = "Sydney temperature by season",
  subtitle = "Data from 2013 to 2018"
) +
xlab("Temperature (Celsius)") +
ylab("") 

print(pic) #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r baseplot_printed, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temp_airport) 
) + 
facet_wrap(vars(season)) + 
theme_bw() +
ggtitle( 
  label = "Sydney temperature by season",
  subtitle = "Data from 2013 to 2018"
) +
xlab("Temperature (Celsius)") +
ylab("") 

print(pic)
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
What are you????
```{r class_info, eval=TRUE, message = FALSE, echo=TRUE, cache=TRUE, warning=FALSE}
class(pic)
```
]]]
]




<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
What is in you????
```{r str_info, eval=TRUE, message = FALSE, echo=TRUE, cache=TRUE, warning=FALSE}
str(pic)
```
]]]
]




<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
Okaaaay .... what are the *names* of the things in you????
```{r names_info, eval=TRUE, message = FALSE, echo=TRUE, cache=TRUE, warning=FALSE}
names(pic)
```
]]]
]




<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
Example 1: data
```{r, eval=TRUE, message = FALSE, echo=TRUE, cache=TRUE, warning=FALSE}
pic$data
```
]]]
]




<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
Example 2: mapping
```{r, eval=TRUE, message = FALSE, echo=TRUE, cache=TRUE, warning=FALSE}
pic$mapping
```
]]]
]


<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
Quick overview: 
- data: the actual data
- layers: what to plot and how to render it
- scales: how to render x-axis, colour
- mapping: which variables map to which scales
- theme: visual styling information
- coordinates: how to lay it out? Cartesian, polar, etc?
- facet: how to break the plot into facets
- plot_env: environment in which to do computation
- labels: axis labels, titles etc.
]]]
]


<!-- *********** NEW SLIDE ************** -->
---

class: center middle hide-slide-number

.pad1[
.font4[
Exercise: Peeking inside the gg object <br>
https://djnavarro.github.io/some_url_here
]]


<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[What goes in a layer?]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Layers can compute things!
```{r, eval=FALSE, message = FALSE}
pic 
```


]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r no_histogram, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Layers can compute things!
```{r, eval=FALSE, message = FALSE}
pic_hist <- pic +  #<<
  geom_histogram() #<<

pic_hist
```

- histograms are not "in the data"
- this is computed by the layer...
- (...sort of)

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_histogram, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic_hist <- pic + geom_histogram()
pic_hist
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Layers can compute things!
```{r, eval=FALSE, message = FALSE}
pic_hist <- pic + 
  geom_histogram() 

pic_dens <- pic + #<<
  geom_density() #<<

pic_dens
```


]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_density, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic_hist <- pic + 
  geom_histogram() 

pic_dens <- pic + 
  geom_density() #<<

pic_dens
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
The layer information... density
```{r, eval=TRUE, message = FALSE}
pic_dens$layers
```

Each layer specifies:
- A geom: the graphical object to be drawn
- A stat: what "statistic" it is applied to
- A position: how it is placed

]]]
]]
--

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
The layer information... histogram
```{r, eval=TRUE, message = FALSE}
pic_hist$layers
```

<br>
- There is hidden complexity!
- It's a bit weird
- We'll come back to this


]]]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: center middle hide-slide-number

.pad1[
.font4[
Exercise: Stats, geoms and layers <br>
https://djnavarro.github.io/some_url_here
]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 middle center

.pull.left[.pad1[.font2[
- List of 
- Useful resources
- Goes here
]]]

<!-- DONE -->
---

class: bg-main1 middle center

## thank u, next


