---
title: "Data Visualisation in R"
subtitle: "From ggplot2 to gganimate"
author: "<br><br>Danielle Navarro &nbsp;&nbsp;&nbsp;`r anicon::faa('twitter', animate='float', rtext=' @djnavarro')`"
date: "<a href='https://djnavarro.github.io/satrdayjoburg/'>https://djnavarro.github.io/satrdayjoburg/</a><br><br>5 April 2019"
output:
  xaringan::moon_reader:
    lib_dir: libs
    chakra: libs/remark-latest.min.js    
    css: ["kunoichi", "ninjutsu" , "assets/ninpo.css", "assets/danielle.css"]
    self_contained: false
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE, message = FALSE}
options(htmltools.dir.version = FALSE)
library(here)
library(tidyverse)
beaches <- read_csv(here("data","sydneybeaches3.csv"))
```

class: split-two bg-main1

.column.bg-main1[.content.vmiddle.center[

# Data visualisation


]]

.column.bg-main3[.content.vmiddle.center[

<img src="images/horst_ggplot.png", width="70%">

[@allison_horst](https://twitter.com/allison_horst)

]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[A plot of the Sydney Beaches data]
]]





<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 middle center

.pull.left[.pad1[.font2[
```{r beachesdata, eval=TRUE, message=FALSE}
# load data
beaches <- read_csv(here("data","sydneybeaches3.csv")) 

# show data
beaches
```
]]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[

A simple plot

```{r, eval=FALSE, message = FALSE}
ggplot(
  beaches, 
  aes(temperature, rainfall)
) + 
geom_point()
```

- A little verbose?
- Not the prettiest plot?
- Why is it like this?

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r introplot, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(beaches, aes(temperature, rainfall)) + geom_point()
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Painting a Picture]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[

.center[
# ggplot2 is...
]
<br>

## A grammar...

- grammars compose & reuse small parts
- complex structures from simpler units

## ...of graphics

- uses the "painters model"
- a plot is built in layers
- each layer is drawn on top of the last

]]]
]]

.column.bg-main3[.content.vmiddle.center[

<img src="images/trinity-treft-696428-unsplash.jpg", width="70%">

[Image credit: Trinity Treft](https://unsplash.com/photos/waYWz3vAYJQ)

]]







<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[

A blank canvas

```{r, eval=FALSE, message = FALSE}
ggplot()
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r blankcanvas, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE}
ggplot() 
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Specify the .orange[data]
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches #<<
)
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r stillblankcanvas, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE}
ggplot(
  data = beaches #<<
) 
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
A .orange[mapping] from data onto plot .orange[aesthetics]
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(      #<<
    x = temperature, #<<
    y = rainfall       #<<
  )                   #<<
)
```


- .orange[x]-axis location
- .orange[y]-axis location
- .orange[colour] of marker
- .orange[fill] of a marker
- .orange[shape] of a marker, etc.
]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r aesthetics, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
)
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add a plot .orange[layer]
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point() #<<
```

- the .orange[points]
- the .orange[lines]
- the .orange[histograms]
- etc

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_layer, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point() #<<
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add layer-specific parameters
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(size = 3) #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_fixedaesthetic, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(size = 3) #<<
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add layer-specific mappings
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), #<<
  size = 3
)   
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_layeraesthetic, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), #<<
  size = 3
) 
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Add more layers to the plotcake
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name),
  size = 3
) + 
geom_rug() #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r two_layers, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 3
) + 
geom_rug()
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Split into .orange[facets]
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2
) + 
geom_rug() + 
facet_wrap(vars(season_name)) #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_facets, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2
) + 
geom_rug() + 
facet_wrap(vars(season_name)) #<<
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Remove an unwanted legend?
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE #<<
) + 
geom_rug() + 
facet_wrap(vars(season_name)) 
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r remove_legend, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE #<<
) + 
geom_rug() + 
facet_wrap(vars(season_name)) 
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Modify the .orange[theme]
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE 
) + 
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() #<<
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_theme, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE #<<
) +
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() 
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
(Nothing to see here...)
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall)) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE) + 
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw()
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_theme2, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE #<<
) +
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() 
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Make nicer titles
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall)) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE) +  
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() +
labs( #<<
  title = "Sydney weather by season", #<<
  subtitle = "Data from 2013 to 2018", #<<
  x = "Temperature (Celsius)", #<<
  y = "Rainfall (mm)" #<<
) #<<

```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_titles, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE
) +
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() + 
labs( #<<
  title = "Sydney weather by season", #<<
  subtitle = "Data from 2013 to 2018", #<<
  x = "Temperature (Celsius)", #<<
  y = "Rainfall (mm)" #<<
) #<<
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Done! Our plotcake is baked.
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall)) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE) +  
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() +
labs( 
  title = "Sydney weather by season", 
  subtitle = "Data from 2013 to 2018", 
  x = "Temperature (Celsius)", 
  y = "Rainfall (mm)" 
) 
```
]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r done, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = beaches,
  mapping = aes(
    x = temperature, 
    y = rainfall
  ) 
) + 
geom_point(
  mapping = aes(colour = season_name), 
  size = 2,
  show.legend = FALSE
) +
geom_rug() + 
facet_wrap(vars(season_name)) + 
theme_bw() + 
labs( #<<
  title = "Sydney weather by season", #<<
  subtitle = "Data from 2013 to 2018", #<<
  x = "Temperature (Celsius)", #<<
  y = "Rainfall (mm)"
) #<<
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.content.vtop.center[
.pull.left[.pad1[.font2[
Ingredients of this plot/cake 
- Data
- Aesthetics
- Layers
- Facets
- Theme
- Labels
- (Coordinates)
- (Scales)
]]]
]






<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 01<br>
]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Aesthetics]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Let's create a plot with no layers!
```{r, eval=FALSE, message = FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temperature) 
) + 
facet_wrap(vars(season_name)) + 
theme_bw() +
labs( 
  title = "Sydney temperature by season", 
  subtitle = "Data from 2013 to 2018", 
  x = "Temperature (Celsius)", 
  y = "" 
) 
```

]]]
]]

.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r baseplot_noprint, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic <- ggplot(
  data = beaches,
  mapping = aes(x = temperature) 
) + 
facet_wrap(vars(season_name)) + 
theme_bw() +
labs( 
  title = "Sydney temperature by season", 
  subtitle = "Data from 2013 to 2018", 
  x = "Temperature (Celsius)", 
  y = "" 
) 
```

]]
]]








<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 02<br>
]]


<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Geoms]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 03<br>
]]





<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[How are layers structured?]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Layers can compute things!
```{r, eval=FALSE, message = FALSE}
pic 
```


]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r no_histogram, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic
```

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Layers can compute things!
```{r, eval=FALSE, message = FALSE}
pic_hist <- pic +  #<<
  geom_histogram() #<<

pic_hist
```

- histograms are not "in the data"
- this is computed by the layer...
- (...sort of)

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_histogram, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic_hist <- pic + geom_histogram()
pic_hist
```

]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[

.pull.left[.pad1[.font2[
Layers can compute things!
```{r, eval=FALSE, message = FALSE}
pic_hist <- pic + 
  geom_histogram() 

pic_dens <- pic + #<<
  geom_density() #<<

pic_dens
```


]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r add_density, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic_hist <- pic + 
  geom_histogram() 

pic_dens <- pic + 
  geom_density() #<<

pic_dens
```

]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
The layer information... density
```{r, eval=TRUE, message = FALSE}
pic_dens$layers
```

Each layer specifies:
- A geom: the graphical object to be drawn
- A stat: what "statistic" it is applied to
- A position: how it is placed

]]]
]]
--

.column.bg-main3[.content.vtop.center[
.pull.left[.pad1[.font2[
The layer information... histogram
```{r, eval=TRUE, message = FALSE}
pic_hist$layers
```

<br>
- There is hidden complexity!
- It's a bit weird
- Let's dig into this...


]]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Our histogram...
```{r, eval=FALSE, message = FALSE}
pic + geom_histogram(
  stat = "bin",
  position = "stack"
) 
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic + geom_histogram(
  stat = "bin",
  position = "stack"
) 
```

]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
The exact same histogram!
```{r, eval=FALSE, message = FALSE}
pic + stat_bin(
  geom = "bar",
  position = "stack"
) 
```
- How would we check?
- Is it exactly the same?
]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic + stat_bin(
  geom = "bar",
  position = "stack"
) 
```


]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Changing the default geom?
```{r, eval=FALSE, message = FALSE}
pic + stat_bin(
  geom = "point",
  position = "stack"
) 
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic + stat_bin(
  geom = "point",
  position = "stack"
) 
```
]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Another way to do the same thing
```{r, eval=FALSE, message = FALSE}
pic + geom_point(
  stat = "bin",
  position = "stack"
) 
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
pic + geom_point(
  stat = "bin",
  position = "stack"
)
```
]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[

<br>
## [But whhhyyyyy??????](https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html)

"Next we write a layer function. Unfortunately, due to an early design mistake I called these either stat\_() or geom\_(). A better decision would have been to call them layer\_() functions: that’s a more accurate description because every layer involves a stat and a geom."


]]]
]]
--
.column.bg-main3[.content.vmiddle.center[

<img src="images/hadley.gif", width="70%">

[Hadley Wickham](https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html)

]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 04<br>
]]




<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Positioning]
]]



<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 05<br>
]]


<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Stats]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 06<br>
]]


<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Facetting]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 07<br>
]]




<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Scales (location)]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 08<br>
]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Scales (colour/fill)]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 09<br>
]]




<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Coordinates]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
(Some preprocessing...)
```{r, eval=TRUE, message = FALSE}
rain <- beaches %>% 
  group_by(
    month, year, season_name
    ) %>%
  summarise(
    rain = mean(rainfall)
  ) %>%
  ungroup() %>%
  spread(
    key = year, 
    value = rain
  )
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
rain <- beaches %>% 
  group_by(month, year, season_name) %>%
  summarise(
    temp = mean(rainfall)
  ) %>%
  ungroup() %>%
  spread(
    key = year, 
    value = temp
  )

rain
```
]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple scatterplot
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) 
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5)
```
]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple scatterplot
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline( #<<
  slope = 1, #<<
  intercept = 0 #<<
) #<<
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline(
  slope = 1, 
  intercept = 0
)
```
]]
]]






<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple scatterplot
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline( 
  slope = 1, 
  intercept = 0 
) + 
coord_equal() #<<
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline(
  slope = 1, 
  intercept = 0
) + 
coord_equal()
```
]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple scatterplot
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline( 
  slope = 1, 
  intercept = 0 
) + 
coord_equal(
  xlim = c(0, 25), #<<
  ylim = c(0, 25) #<<
)
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline(
  slope = 1, 
  intercept = 0
) + 
coord_equal(
  xlim = c(0, 25), #<<
  ylim = c(0, 25) #<<
)
```
]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple scatterplot
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline( 
  slope = 1, 
  intercept = 0 
) + 
coord_cartesian( #<<
  xlim = c(0, 25), 
  ylim = c(0, 25) 
)
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x = `2013`,
    y = `2017`,
    colour = season_name
  )
) + 
geom_point(size = 5) + 
geom_abline(
  slope = 1, 
  intercept = 0
) + 
coord_cartesian(
  xlim = c(0, 25), #<<
  ylim = c(0, 25) #<<
)
```
]]
]]








<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple bar plot
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x =  month,
    y = `2017`,
    colour = season_name,
    fill = season_name
  )
) + 
geom_col()
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x =  month,
    y = `2017`,
    colour = season_name,
    fill = season_name
  )
) + 
geom_col() 
```
]]
]]








<!-- *********** NEW SLIDE ************** -->
---
class: split-40 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
A simple bar plot, ruined
```{r, eval=FALSE, message = FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x =  month,
    y = `2017`,
    colour = season_name,
    fill = season_name
  )
) + 
geom_col() + 
coord_polar() #<<
```


]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
ggplot(
  data = rain,
  mapping = aes(
    x =  month,
    y = `2017`,
    colour = season_name,
    fill = season_name    
  )
) + 
geom_col() + 
coord_polar() #<<
```
]]
]]




<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 10<br>
]]



<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Themes]
]]


<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 11<br>
]]


<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Extensions (in brief!)]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Overriding defaults

```{r, eval=FALSE, message = FALSE}
geom_dothistogram <- function(
  geom = "point", ...){
  
  layer <- stat_bin(geom = geom, ...)
  return(layer)
}

pic + geom_dothistogram(size = 3) #<<

```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
geom_dothistogram <- function(
  geom = "point", ...
  ) {
  
  layer <- stat_bin(geom = geom, ...)
  return(layer)
  
}

pic + geom_dothistogram(size = 3) #<<
```
]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Overriding defaults

```{r, eval=FALSE, message = FALSE}
geom_dothistogram <- function(
  mapping = NULL, data = NULL, 
  position = "stack", ..., 
  binwidth = NULL, bins = NULL, 
  na.rm = FALSE, show.legend = NA, 
  inherit.aes = TRUE
){
  
  layer <- stat_bin(
    mapping = mapping, data = data, 
    geom = "point", position = position,
    ..., binwidth = binwidth, 
    bins = bins, na.rm = na.rm, 
    show.legend = show.legend,
    inherit.aes = inherit.aes
  )
  return(layer)
}

pic + geom_dothistogram(size = 3) #<<
```

]]]
]]


.column.bg-main3[.content.vtop.center[
.pad1[.font2[
```{r, eval=TRUE, message = FALSE, echo=FALSE, cache=TRUE, warning=FALSE}
geom_dothistogram <- function(
  mapping = NULL, data = NULL, position = "stack", 
  ..., binwidth = NULL, bins = NULL, na.rm = FALSE, 
  show.legend = NA, inherit.aes = TRUE
){
  
  layer <- stat_bin(
    mapping = mapping, data = data, 
    geom = "point", position = position,
    ..., binwidth = binwidth, bins = bins,
    na.rm = na.rm, show.legend = show.legend,
    inherit.aes = inherit.aes
  )
  
  return(layer)
}

pic + geom_dothistogram(size = 3) #<<
```
]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Entirely new geoms rely on .orange[grid] graphics...

```{r, eval=TRUE, message = FALSE}
my_arrow <- function(data, panel_params, coord) {
  coords <- coord$transform(data, panel_params)
  trans <- function(coords, fun) {
    coords$length * coords$size * fun(2 * pi * coords$direction / 360)
  }

  grid::polylineGrob(
    x = c(coords$x, coords$x + trans(coords, cos)),
    y = c(coords$y, coords$y + trans(coords, sin)),
    id = c(1:length(coords$x), 1:length(coords$x)),
    arrow = arrow(
      angle = 30,
      length = unit(coords$size * coords$length/2, "native")),
    default.units = "native",
    gp = grid::gpar(col = coords$colour, lwd = coords$linewidth)
  )
}
```

]]]
]]





<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Then we create a new .orange[ggproto] object...

```{r, eval=TRUE, message = FALSE}
GeomVector <- ggproto(
  "GeomVector", Geom,
  required_aes = c("x", "y", 
                   "direction", "length"),
  default_aes = aes(
    colour = "black", fill = NA, size = .025,
    linetype = 1, alpha = 1, linewidth = 1
  ),
  draw_key = draw_key_point,
  draw_panel = my_arrow
)

```

]]]
]]

--

.column.bg-main3[.content.vtop.center[
.pad1[.font2[

What are you???

]]
]]




<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Now we define the layer function...

```{r, eval=TRUE, message = FALSE}
geom_vector <- function(
  mapping = NULL, data = NULL,
  stat = "identity", position = "identity",
  na.rm = FALSE, show.legend = NA,
  inherit.aes = TRUE, ...) {

  ggplot2::layer(
    geom = GeomVector, mapping = mapping,
    data = data, stat = stat,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(na.rm = na.rm, ...)
  )
}

```

]]]
]]



<!-- *********** NEW SLIDE ************** -->
---
class: split-50 bg-main1

.column.bg-main1[.content.vtop.center[
.pull.left[.pad1[.font2[
Now we use it!

```{r, eval=FALSE, message = FALSE}
vectors <- read_csv(
  here("data","vector_field.csv"))

ggplot(
  data = vectors,
  mapping = aes(
    x = xval,
    y = yval,
    direction = dir,
    length = len,
    colour = cosx)
  ) +
  geom_vector(linewidth = 2)
```

]]]
]]


--

.column.bg-main3[.content.vtop.center[
.pad1[.font2[

```{r, eval=TRUE, echo=FALSE, cache=TRUE, warning=FALSE, message = FALSE}
vectors <- read_csv(
  here("data","vector_field.csv"))

ggplot(
  data = vectors,
  mapping = aes(
    x = xval,
    y = yval,
    direction = dir,
    length = len,
    colour = cosx)
  ) +
  geom_vector(linewidth = 2)
```
]]
]]







<!-- *********** NEW SLIDE ************** -->
---

class: white bg-black center middle hide-slide-number

.pad1[
.font4[
Exercise 12<br>
]]





<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 center middle hide-slide-number

.reveal-text.bg-main2[.pad1[
.font4[Animation]
]]










<!-- *********** NEW SLIDE ************** -->
---

class: bg-main1 middle center

.pull.left[.pad1[.font2[
- List of 
- Useful resources
- Goes here
]]]

<!-- DONE -->
---

class: bg-main1 middle center

## thank u


